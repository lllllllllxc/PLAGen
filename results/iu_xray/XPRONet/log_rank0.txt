[2024-11-02 08:04:54 XPRONet] (train_rl.py 181): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume=None, sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=50, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=32, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-02 08:04:54 XPRONet] (train_rl.py 183): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-02 08:04:54 XPRONet] (train_rl.py 186): INFO number of params: 61285177
[2024-11-02 08:13:11 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume=None, sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=50, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=32, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-02 08:13:11 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-02 08:13:11 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-02 08:13:49 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume=None, sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=50, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-02 08:13:49 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-02 08:13:49 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-02 09:15:22 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume=None, sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=50, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-02 09:15:22 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-02 09:15:22 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:30:32 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:30:32 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:30:32 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:32:07 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:32:07 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:32:07 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:32:52 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:32:52 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:32:52 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:36:23 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:36:23 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:36:23 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:40:49 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:40:49 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:40:49 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:42:58 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:42:58 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:42:58 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:43:35 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:43:35 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:43:35 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:46:23 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:46:23 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:46:23 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:48:53 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:48:53 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:48:53 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 12:50:25 XPRONet] (train_rl.py 200): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 12:50:25 XPRONet] (train_rl.py 202): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 12:50:25 XPRONet] (train_rl.py 205): INFO number of params: 61285177
[2024-11-04 13:05:07 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 13:05:07 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 13:05:07 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 13:05:42 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 13:05:42 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 13:05:42 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 13:06:37 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 13:06:37 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 13:06:37 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 13:29:55 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 13:29:55 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 13:29:55 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 14:07:27 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 14:07:27 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 14:07:27 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 19:00:00 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 19:00:00 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 19:00:00 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 19:02:46 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=6, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9233, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 19:02:46 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 19:02:46 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 19:35:31 XPRONet] (train_rl.py 201): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=8, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=7580, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 19:35:31 XPRONet] (train_rl.py 203): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 19:35:31 XPRONet] (train_rl.py 206): INFO number of params: 61285177
[2024-11-04 20:14:25 XPRONet] (train_rl.py 203): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=8, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=9778, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-04 20:14:25 XPRONet] (train_rl.py 205): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-04 20:14:25 XPRONet] (train_rl.py 208): INFO number of params: 61285177
[2024-11-05 10:03:03 XPRONet] (train_rl.py 196): INFO Namespace(adam_betas=(0.9, 0.98), adam_eps=1e-09, amsgrad=True, ann_path='../XproNet/data/iu_xray/annotation.json', batch_size=8, beam_size=3, block_trigrams=1, bos_idx=0, cmm_dim=512, cmm_size=2048, d_ff=512, d_img_ebd=768, d_model=512, d_txt_ebd=2048, d_vf=2048, dataset_name='iu_xray', decoding_constraint=0, drop_prob_lm=0.5, dropout=0.1, early_stop=50, eos_idx=0, epochs=250, exp_name='XPRONet', gamma=0.1, gbl_num_protype=10, group_size=1, image_dir='../XproNet/data/iu_xray/resnet34_300/images300_seg/', img_con_margin=0.4, img_init_protypes_path='../XproNet/data/iu_xray/init_protypes_512.pt', img_num_protype=10, init_protypes_path='../XproNet/data/iu_xray/init_prototypes.pt', label_path='../XproNet/data/iu_xray/labels/labels_14.pickle', local_rank=0, log_period=100, logit_layers=1, lr_ed=1e-05, lr_scheduler='StepLR', lr_ve=1e-06, max_seq_length=60, monitor_metric='BLEU_4', monitor_mode='max', n_gpu=1, noamopt_factor=1, noamopt_warmup=5000, num_cluster=14, num_heads=8, num_labels=14, num_layers=3, num_protype=20, num_workers=2, optim='Adam', output='results', output_logsoftmax=1, pad_idx=0, record_dir='records_COMG/', reduce_on_plateau_factor=0.5, reduce_on_plateau_patience=3, resume='../XproNet/results/iu_xray/0.484.pth', sample_method='beam_search', sample_n=1, save_dir='results/iu_xray', save_period=1, sc_beam_size=1, sc_eval_period=10000, sc_sample_method='greedy', seed=7061, start_eval_epoch=0, step_size=1, temperature=1.0, test_after=False, text_init_protypes_path='../XproNet/data/iu_xray/text_empty_initprotypes_512.pt', text_num_protype=10, threshold=3, topk=15, train_beam_size=1, train_sample_method='sample', train_sample_n=1, txt_con_margin=0.4, use_bn=0, visual_extractor='resnet101', visual_extractor_pretrained=True, weight_decay=5e-05, weight_img_bce_loss=0, weight_img_con_loss=1, weight_txt_bce_loss=0, weight_txt_con_loss=0.1)
[2024-11-05 10:03:03 XPRONet] (train_rl.py 198): INFO RANK and WORLD_SIZE in environ: 0/1
[2024-11-05 10:03:03 XPRONet] (train_rl.py 201): INFO number of params: 61285177
